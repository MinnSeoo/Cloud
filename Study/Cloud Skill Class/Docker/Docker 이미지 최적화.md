# **Docker 컨테이너의 Layer를 최소화 하는 방법**

Docker 컨테이너의 Layer를 최소화 한다는 것은 Docker 이미지를 최적화 한다는 의미와
일맥상통하다. 

<br>

 **WHY ? ? ?**  (왜 Docker file을 최적화 하려는 걸까?) <br>
→ **OS에서 잘 사용하기 위해서!**

<br>

그럼 OS에서 잘 사용하려면 어떤 특징을 가져야 할까?

<br>

- **1) 시공간 자원(CPU,메모리…등)을 효과적으로 활용한다.**
    
    컨테이너가 사용하는 ps(프로세스) 수를 줄여준다면 CPU 입장에서는 덜 힘들어지게 된다.
    img 용량을줄이고 빌드 과정의 캐싱을 활용하면 디스크와 메모리 자원을 효율적으로 
    사용할 수 있게 된다.

    <br>
    
- **2) 요청과 응답의 원자성 보장**
    
    (예를 들어 client가 server에 하나의 요청을 보냈다고 가정하겠다.)
    
    만약 server가 이 요청을 아직 다 처리하지 못했는데 개발자가 배포를 진행해 버리면
    결국 응답을 보내지 못한채 server는 종료될 것이고, 결국 user는 당황스러운 상황에 놓이게 된다.
    **요청과 응답의 원자성을 보장해준다는 건 이러한 일이 일어나지 않도록 하겠다는 뜻**이다.
    
    이를 위해 **Linux에서는 POSIX signal**이라는 것이 존재하고, 개발작 할 일은 컨테이너가 올바른 종료
    신호를 잘 받을 수 있도록 설정해 주면 된다.
    
    [ **POSIX signal ]**
    
    POSIX signal은 다른말로 Unix signal(유닉스 신호)라고 한다.
    
    신호는 UNIX, UNIX 계얼 및 POSIX 호환 운영 체제에 쓰이는 제한된 형태의 ps간 통신이다.
    

    <br>

- **3) 필요한 요소는 강제한다.**
    
    필요한요소를 강제한다는 것은 **예상하지 못한 실행 환경에 Docker img를 노출시키지 않는다는
    뜻**이다. Docker img의 실행 명령어는 때에 따라서 개발자의 의도와는 다르게 덮어씌어질 수 있다.
    이때 Docker는 ENTRYPOINT를 바탕으로 실행 명령어를 강제할 수 있기 때문에 이를 통해 개발자가
    의도한 대로만 실행 시킬 수 있다.
    



# **5-1. 배포 관련 용어 및 개념**

## **배포란 ? ? ?**

작성된 코드를 build하고, 문제가 없다고 판단되면 실제 서버 혹은 cloud 환경의
서버 환경에 합쳐진 코드를 올리는 과정이다.

<br>

## **배포 전략**

배포에도 여러가지 전략들이 있다. 그 중에서 **무중단/중단 배포**, **현재 위치 패포**, **블루/그린 배포**에 대하여 알아보려고 한다.

<br>

### **무중단/중단 배포**

무중단/중단 배포는 용어 그대로 놓고 보면 배포 시 서비스를 중단할지 안 할지의 차이가 있다.

서비스를 중단하지 않은 상태로 배포 한다는 것은 배포시 사용자가 문제없이 서비스를 사용할 수 있다는 것을 뜻한다. 그리고 중단 배포는 사용자가 서비스를 사용하지 못하게 시스템 전체를 정지한 뒤 배포를 진행하는 것을 뜻한다.

**[+ 나의 생각 ]**

나는 무중단 배포와 중단 배포 단어만 들었을때는 중단 배포가 더 안 좋은것 아닌가? 하고 생각했다.

왜냐하면 서버를 중단시킬 경우 사용자가 서버를 사용하지 못하는 시간이 생기기 때문에, 사용자 편의상 안 좋기 때문에 그렇게 생각을 했다. 근데 이 단원을 읽어보니 꼭 중단 배포가 안 좋은 것만은 아니였다.

<br>

중단 배포를 하는 이유중 하나가 무중단 배포를 하기엔 너무 큰 서비스이다 보니 너무나도 큰 비용이 발생하기 때문이다. 그리고 한 서비스에 애플리케이션 코드나 DB 스키마 등 구버전과 신버전이 동시에 서비스되면 안 되는 경우에도 중단 배포를 사용한다.

<br>

### **현재 위치 배포**

현재 위치 배포는 무중단 배포를 하기 위한 기법의 하나로 여러 대의 서버를 배포할 때 새롭게 서버를 생성하거나 줄이지 않고 배포하는 방법을 뜻한다.

현재 위치 배포는 새로운 인스턴스를 생성할 필요가 없기 때문에 좀 더 간단하고 빠르다는 장점이 있다. 하지만 배포 중에는 Client의 요청을 처리할 수 있는 인스턴스 수가 줄어들 수 있다는 점에 유의 해야한다.

<br>

### **Blue/Green 배포**

Blue/Green 배포도 현재 위치 배포와 마찬가지로 무중단 배포를 하기 위한 기법중 하나이다.

우선 Blue/Green 배포는 어떤식으로 동작하는지 알아보겠다.

<br>

<img width="842" alt="image" src="https://github.com/MinnSeoo/Cloud/assets/102645965/b039c658-9d80-4fde-82dc-88139c4f624e">


현재 blue group 안에서 두 개의 서버로 요청을 나눠서 처리하고 있다고 가정하겠다.

현재는 blue group 안에 있는 v.1.01 버전을 서비스 하고 있다.

그러다가 v.1.02 버전을 개발해서 이제 v.1.02 버전을 배포하여 서비스 하려고 한다.

<br>

<img width="837" alt="image" src="https://github.com/MinnSeoo/Cloud/assets/102645965/12c2e812-847b-4297-a85d-666d493a534d">

<br>

그럴려면 먼저 Blue Group에 존재하는 ec2 수 만큼 Green Group에 생성하는 과정이 일어난다.

그리고 Green Group에 v.1.02 버전을 배포한다. 이렇게 Blue/Green 배포는 2개의 그룹을 가지고 진행된다. 여기서 얘기하는 그룹은 **대상그룹(tg)**이 될 수도 있고, **Auto Scailng**이 될 수도 있다.

<br>

<img width="841" alt="image" src="https://github.com/MinnSeoo/Cloud/assets/102645965/2d5fe5c9-ee27-4294-84c7-3e551e68d491">


그 다음 Blue/Green 모두 Load Balancer에 연결해서 잠시 동안 두개의 그룹 모두 트래픽을 처리하도록 한다.

<br>

<img width="847" alt="image" src="https://github.com/MinnSeoo/Cloud/assets/102645965/f602da42-c22c-4482-a1da-8d173a2889bd">


그리고 나서 Blue Group에 있는 인스턴스의 서비스를 종료한 후에 Load Banlancer에게 Blue Group을 제외하고 Green Group에서 모든 트래픽을 처리하도록 한다.

<br>

**[Blue/Green 배포의 장점]**

- 구, 신버전이 **동시에 떠 있는 시간**을 매우 **짧게 처리**할 수 있다.
    
    (두 버전이 동시에 떠 있어서 발생하는 **장애의 위험 부담**을 줄일 수 있음.)
    

- 롤백을 **굉장히 빨리**할 수 있다.


